2025-06-14 20:08:50,065 - INFO - Start logger
------------ CONFIGURATE ------------ 
{'model': {'name': 'meta-llama/Llama-3.1-8B-Instruct', 'model_name_log': 'Llama-3.1-8B-Instruct', 'cache_dir': '../ft_v1/models_cache/models--meta-llama--Llama-3.1-8B-Instruct/snapshots/0e9e39f249a16976918f6564b8830bc894c89659/', 'quant_config': None, 'max_length': 512, 'max_new_tokens': 32, 'tokenizer': {'padding_size': 'left', 'answer_pattern': '### answer:\n'}}, 'lora': {'r': 16, 'lora_alpha': 32, 'lora_dropout': 0.05, 'target_modules': ['q_proj', 'o_proj', 'v_proj', 'k_proj']}, 'inference': {'temp': 0.4}, 'evaluate_model': {'checkpoint': 'checkpoint-150/'}, 'train': {'model_save_dir': './saved_models', 'epochs': 2, 'train_batch': 2, 'val_batch': 1, 'test_batch': 1, 'grad_accum': 256, 'eval_step': 25, 'save_step': 25, 'torch_empty_cache_steps': 8, 'log_step': 15, 'lr': 2e-05, 'weight_decay': 0.01}, 'logs': {'dir': './logs'}}
------------ ------------
2025-06-14 20:08:50,065 - INFO - Продолжаем обучение c сохранения: ./saved_models/train__14-06-2025_06-57-34__Llama-3.1-8B-Instruct/checkpoint-150/
2025-06-14 20:08:50,067 - INFO - PyTorch: setting up devices
2025-06-14 20:08:50,264 - INFO - Using auto half precision backend
2025-06-14 20:08:50,265 - WARNING - No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
2025-06-14 20:08:50,265 - INFO - Start training for model Llama-3.1-8B-Instruct
2025-06-14 20:08:50,265 - INFO - Loading model from ./saved_models/train__14-06-2025_06-57-34__Llama-3.1-8B-Instruct/checkpoint-150/.
2025-06-14 20:08:50,401 - INFO - skipped Embedding(128256, 4096): 501.0M params
2025-06-14 20:08:50,402 - INFO - skipped: 501.0M params
2025-06-14 20:08:50,469 - INFO - ***** Running training *****
2025-06-14 20:08:50,469 - INFO -   Num examples = 58,038
2025-06-14 20:08:50,469 - INFO -   Num Epochs = 2
2025-06-14 20:08:50,469 - INFO -   Instantaneous batch size per device = 2
2025-06-14 20:08:50,469 - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 512
2025-06-14 20:08:50,469 - INFO -   Gradient Accumulation steps = 256
2025-06-14 20:08:50,469 - INFO -   Total optimization steps = 228
2025-06-14 20:08:50,471 - INFO -   Number of trainable parameters = 13,631,488
2025-06-14 20:08:50,471 - INFO -   Continuing training from checkpoint, will skip to saved global_step
2025-06-14 20:08:50,471 - INFO -   Continuing training from epoch 1
2025-06-14 20:08:50,471 - INFO -   Continuing training from global step 150
2025-06-14 20:08:50,471 - INFO -   Will skip the first 1 epochs then the first 9216 batches in the first epoch.
